<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Walkthrough &#8212; Scanner 0.2.22 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<link rel="stylesheet"
      href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/styles/atelier-cave-light.min.css">
<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

  </head><body>
<a href="https://github.com/scanner-research/scanner" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70B7FD; color:#fff; position: absolute; top: 0; border: 0; right: 0; z-index: 1;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>


 <div id="navbar" class="navbar navbar-scanner ">
    <div class="container navbar-container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/scanner_logo.png"></span>
           </a>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../guide.html" class="navbar-link">Guide</a></li>
                <li><a href="../api.html" class="navbar-link">API</a></li>
                <li><a href="https://github.com/scanner-research/scanner" class="navbar-link">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="walkthrough">
<span id="quickstart"></span><h1>Walkthrough<a class="headerlink" href="#walkthrough" title="Permalink to this headline">¶</a></h1>
<p>To explain how Scanner is used, let’s walk through a simple example that reads every third frame from a video, resizes the frames, and then creates a new video from the sequence of resized frames.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This document walks you through a very basic Scanner application that downsamples a video in space and time. Once you are done with this guide, check out the <a class="reference external" href="https://github.com/scanner-research/scanner/blob/master/examples">examples</a> directory for more useful applications, such as using Tensorflow <a class="reference external" href="https://github.com/scanner-research/scanner/blob/master/examples/apps/object_detection_tensorflow">for detecting objects in all frames of a video</a> and Caffe for <a class="reference external" href="https://github.com/scanner-research/scanner/blob/master/examples/apps/face_detection">face detection</a>.</p>
</div>
<p>To run the code discussed here, install Scanner (<a class="reference internal" href="../installation.html#installation"><span class="std std-ref">Installation</span></a>). Then from the top-level Scanner directory, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> examples/apps/quickstart
wget https://storage.googleapis.com/scanner-data/public/sample-clip.mp4
python3 main.py
</pre></div>
</div>
<p>After <code class="code docutils literal notranslate"><span class="pre">main.py</span></code> exits, you should now have a resized version of <code class="code docutils literal notranslate"><span class="pre">sample-clip.mp4</span></code> named <code class="code docutils literal notranslate"><span class="pre">sample-clip-resized.mp4</span></code> in the current directory. Let’s see how that happened by looking inside <code class="code docutils literal notranslate"><span class="pre">main.py</span></code>.</p>
<div class="section" id="starting-up-scanner">
<h2>Starting up Scanner<a class="headerlink" href="#starting-up-scanner" title="Permalink to this headline">¶</a></h2>
<p>The first step in any Scanner program is to create a <a class="reference internal" href="../api/scannerpy.html#scannerpy.database.Database" title="scannerpy.database.Database"><code class="xref py py-class docutils literal notranslate"><span class="pre">Database</span></code></a> object. The <a class="reference internal" href="../api/scannerpy.html#scannerpy.database.Database" title="scannerpy.database.Database"><code class="xref py py-class docutils literal notranslate"><span class="pre">Database</span></code></a> object manages videos or other data that you have may have stored from data processing you’ve done in the past. The Database object also provides the API to construct and execute new video processing jobs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scannerpy</span> <span class="kn">import</span> <span class="n">Database</span><span class="p">,</span> <span class="n">Job</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">Database</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="ingesting-a-video-into-the-database">
<h2>Ingesting a video into the Database<a class="headerlink" href="#ingesting-a-video-into-the-database" title="Permalink to this headline">¶</a></h2>
<p>Scanner is designed to provide fast access to frames in videos, even under random access patterns. In order to provide this functionality, Scanner first needs to analyze the video to build an index on the video. For example, given an mp4 video named <code class="code docutils literal notranslate"><span class="pre">example.mp4</span></code>, we can ingest this video as follow:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">ingest_videos</span><span class="p">([(</span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span> <span class="s1">&#39;example.mp4&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<p>Scanner analyzes the file to build the index and creates a <a class="reference internal" href="../api/scannerpy.html#scannerpy.table.Table" title="scannerpy.table.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> for that video in the Scanner database called <code class="code docutils literal notranslate"><span class="pre">table_name</span></code>. You can see the contents of the database by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">summarize</span><span class="p">())</span>
<span class="go">                      ** TABLES **</span>
<span class="go">---------------------------------------------------</span>
<span class="go">ID | Name       | # rows | Columns      | Committed</span>
<span class="go">---------------------------------------------------</span>
<span class="go">0  | table_name | 360    | index, frame | true</span>
</pre></div>
</div>
<p>By default, ingest copies the video data into the Scanner database (located at <code class="code docutils literal notranslate"><span class="pre">~/.scanner/db</span></code> by default). However, Scanner can also read videos without copying them using the <code class="code docutils literal notranslate"><span class="pre">inplace</span></code> flag.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">ingest_videos</span><span class="p">([(</span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span> <span class="s1">&#39;example.mp4&#39;</span><span class="p">)],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This still builds the index for accessing the video but avoids copying the files
into the database.</p>
</div>
<div class="section" id="defining-a-computation-graph">
<span id="defining-a-graph"></span><h2>Defining a Computation Graph<a class="headerlink" href="#defining-a-computation-graph" title="Permalink to this headline">¶</a></h2>
<p>Now we can tell Scanner how to process the video by constructing a <em>computation graph</em>. A computation graph is a graph of input nodes (<strong>Sources</strong>), function nodes (<strong>Ops</strong>), and output nodes (<strong>Sinks</strong>). <strong>Sources</strong> can read data from the Scanner database (such as the table we ingested above) or from other sources of data, such as the filesystem or a SQL database. <strong>Ops</strong> represent functions that transform their inputs into new outputs. <strong>Sinks</strong>, like <strong>Sources</strong>, write data to the database or to other forms of persistent storage.</p>
<p>Let’s define a computation graph to read frames from the database, select every third frame, resize them to 640 x 480 resolution, and then save them back to a new database table. First, we’ll create a Source that reads from a column in a table:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">FrameColumn</span><span class="p">()</span>
</pre></div>
</div>
<p>But wait a second, we didn’t tell the <strong>Source</strong> the table and column it should read from. What’s going on? Since it’s fairly typical to use the same computation graph to process a collection of videos at once, Scanner adopts a “binding model” that lets the user define a computation graph up front and then later “bind” different videos to the inputs. We’ll see this in action in the <a class="reference internal" href="../quickstart.html#defining-a-job"><span class="std std-ref">Defining Jobs</span></a> section.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">frame</span></code> object returned by the <strong>Source</strong> represents the stream of frames that are stored in the table, and we’ll use it as the input to the next operation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sampled_frame</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">streams</span><span class="o">.</span><span class="n">Stride</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># Select every third frame</span>
</pre></div>
</div>
<p>This is where we select only every third frame from the stream of frames we read from the <strong>Source</strong>. This comes from a special class of ops (from <code class="code docutils literal notranslate"><span class="pre">db.streams</span></code>) that can change the size of a stream, as opposed to transforming inputs to outputs 1-to-1.</p>
<p>We then process the sampled frames by instantiating a Resize <strong>Op</strong> that will resize the frames in the <code class="code docutils literal notranslate"><span class="pre">frame</span></code> stream to 640 x 480:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">resized</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">sampled_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">)</span>
</pre></div>
</div>
<p>This <strong>Op</strong> returns a new stream of frames which we call <code class="code docutils literal notranslate"><span class="pre">resized</span></code>. The Resize <strong>Op</strong> is one of the collection of built-in <strong>Ops</strong> in the <a class="reference internal" href="../api/stdlib.html#standard-library"><span class="std std-ref">Scanner Standard Library</span></a>. (You can learn how to write your own <strong>Ops</strong> by following the <a class="reference internal" href="../tutorial.html#tutorial"><span class="std std-ref">Tutorials</span></a>.)</p>
<p>Finally, we write these resized frames to a column called ‘frame’ in a new table by passing them into a column <strong>Sink</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output_frame</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">sinks</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;frame&#39;</span><span class="p">:</span> <span class="n">resized</span><span class="p">})</span>
</pre></div>
</div>
<p>Putting it all together, we have:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">FrameColumn</span><span class="p">()</span>
<span class="n">sampled_frame</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">streams</span><span class="o">.</span><span class="n">Stride</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">resized</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">sampled_frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">)</span>
<span class="n">output_frame</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">sinks</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;frame&#39;</span><span class="p">:</span> <span class="n">resized</span><span class="p">})</span>
</pre></div>
</div>
<p>At this point, we have defined a computation graph that describes the computation to run, but we haven’t yet told Scanner to execute the graph.</p>
</div>
<div class="section" id="defining-jobs">
<span id="defining-a-job"></span><h2>Defining Jobs<a class="headerlink" href="#defining-jobs" title="Permalink to this headline">¶</a></h2>
<p>As alluded to in <a class="reference internal" href="../quickstart.html#defining-a-graph"><span class="std std-ref">Defining a Computation Graph</span></a>, we need to tell Scanner which table we should read and which table we should write to before executing the computation graph. We can perform this “binding” of arguments to graph nodes using a <strong>Job</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">job</span> <span class="o">=</span> <span class="n">Job</span><span class="p">(</span><span class="n">op_args</span><span class="o">=</span><span class="p">{</span>
    <span class="n">frame</span><span class="p">:</span> <span class="n">db</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;table_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;frame&#39;</span><span class="p">),</span>
    <span class="n">output_frame</span><span class="p">:</span> <span class="s1">&#39;resized_table&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Here, we say that the <code class="code docutils literal notranslate"><span class="pre">FrameColumn</span></code> indicated by <code class="code docutils literal notranslate"><span class="pre">frame</span></code> should read from the column <code class="code docutils literal notranslate"><span class="pre">frame</span></code> in the table <code class="code docutils literal notranslate"><span class="pre">&quot;table_name&quot;</span></code>, and that the output table indicated by <code class="code docutils literal notranslate"><span class="pre">output_frame</span></code> should be called <code class="code docutils literal notranslate"><span class="pre">&quot;resized_table&quot;</span></code>.</p>
</div>
<div class="section" id="running-a-job">
<h2>Running a Job<a class="headerlink" href="#running-a-job" title="Permalink to this headline">¶</a></h2>
<p>Now we can run the computation graph over the video we ingested. This is done by simply calling <code class="code docutils literal notranslate"><span class="pre">run</span></code> on the database object, specifying the jobs and outputs that we are interested in:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output_tables</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output_frame</span><span class="p">,</span> <span class="n">jobs</span><span class="o">=</span><span class="p">[</span><span class="n">job</span><span class="p">])</span>
</pre></div>
</div>
<p>This call will block until Scanner has finished processing the job. You should see a progress bar while Scanner is executing the computation graph. Once the job are done, <code class="code docutils literal notranslate"><span class="pre">run</span></code> returns the newly computed tables, here shown as <code class="code docutils literal notranslate"><span class="pre">output_tables</span></code>.</p>
</div>
<div class="section" id="reading-the-results-of-a-job">
<h2>Reading the results of a Job<a class="headerlink" href="#reading-the-results-of-a-job" title="Permalink to this headline">¶</a></h2>
<p>We can directly read the results of job we just ran in the Python code by querying the <code class="code docutils literal notranslate"><span class="pre">frame</span></code> column on the table <code class="code docutils literal notranslate"><span class="pre">resized_table</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resized_frame</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;resized_table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;frame&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resized_frame</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>Video frames are returned as numpy arrays. Here we are printing out the shape of the frame, which should have a width of 640 and height of 480.</p>
</div>
<div class="section" id="exporting-to-mp4">
<h2>Exporting to mp4<a class="headerlink" href="#exporting-to-mp4" title="Permalink to this headline">¶</a></h2>
<p>We can also directly save the frame column as an mp4 file by calling <code class="code docutils literal notranslate"><span class="pre">save_mp4</span></code> on the <code class="code docutils literal notranslate"><span class="pre">frame</span></code> column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;resized_table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;frame&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">save_mp4</span><span class="p">(</span><span class="s1">&#39;resized-video&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>After this call returns, an mp4 video should be saved to the current working directory called <code class="code docutils literal notranslate"><span class="pre">resized-video.mp4</span></code> that consists of the resized frames that we generated.</p>
<p>That’s a complete Scanner pipeline! If you’d like to learn about process multiple jobs, keep reading! Otherwise, to learn more about the features of Scanner, either follow the <a class="reference internal" href="../walkthrough.html#walkthrough"><span class="std std-ref">Interactive Jupyter Walkthrough</span></a> or go through the extended <a class="reference internal" href="../tutorial.html#tutorial"><span class="std std-ref">Tutorials</span></a>.</p>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="processing-multiple-videos">
<h2>Processing multiple videos<a class="headerlink" href="#processing-multiple-videos" title="Permalink to this headline">¶</a></h2>
<p>Now let’s say that we have a directory of videos we want to process, instead of just a single one as above.
To see the multiple video code in action, run the following commands from the quickstart app directoroy:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://storage.googleapis.com/scanner-data/public/sample-clip-1.mp4
wget https://storage.googleapis.com/scanner-data/public/sample-clip-2.mp4
wget https://storage.googleapis.com/scanner-data/public/sample-clip-3.mp4
python3 main-multi-video.py
</pre></div>
</div>
<p>After <code class="code docutils literal notranslate"><span class="pre">main-multi-video.py</span></code> exits, you should now have a resized version of each of the downloaded videos named <code class="code docutils literal notranslate"><span class="pre">sample-clip-%d-resized.mp4</span></code> in the current directory, where <code class="code docutils literal notranslate"><span class="pre">%d</span></code> is replaced with the number of the video.</p>
<p>There are two places in the code that need to change to process multiple videos. Let’s look at those pieces of code inside <code class="code docutils literal notranslate"><span class="pre">main-multi-video.py</span></code> now.</p>
</div>
<div class="section" id="ingesting-multiple-videos">
<h2>Ingesting multiple videos<a class="headerlink" href="#ingesting-multiple-videos" title="Permalink to this headline">¶</a></h2>
<p>The first change is that we need to ingest all of our videos. This means changing our call to <code class="code docutils literal notranslate"><span class="pre">ingest_videos</span></code> to take a list of three tuples, instead of just one:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">videos_to_process</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;sample-clip-1&#39;</span><span class="p">,</span> <span class="s1">&#39;sample-clip-1.mp4&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;sample-clip-2&#39;</span><span class="p">,</span> <span class="s1">&#39;sample-clip-2.mp4&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;sample-clip-3&#39;</span><span class="p">,</span> <span class="s1">&#39;sample-clip-3.mp4&#39;</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Ingest the videos into the database</span>
<span class="n">db</span><span class="o">.</span><span class="n">ingest_videos</span><span class="p">(</span><span class="n">videos_to_process</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we have three tables that are ready to be processed!</p>
</div>
<div class="section" id="defining-and-executing-multiple-jobs">
<h2>Defining and executing multiple Jobs<a class="headerlink" href="#defining-and-executing-multiple-jobs" title="Permalink to this headline">¶</a></h2>
<p>The second change is to define multiple jobs, one for each video that we want to process.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">jobs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">videos_to_process</span><span class="p">:</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">Job</span><span class="p">(</span><span class="n">op_args</span><span class="o">=</span><span class="p">{</span>
        <span class="n">frame</span><span class="p">:</span> <span class="n">db</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;frame&#39;</span><span class="p">),</span>
        <span class="n">output_frame</span><span class="p">:</span> <span class="s1">&#39;resized-{:s}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can process these multiple jobs at the same time using <code class="code docutils literal notranslate"><span class="pre">run</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output_tables</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output_frame</span><span class="p">,</span> <span class="n">jobs</span><span class="o">=</span><span class="n">jobs</span><span class="p">)</span>
</pre></div>
</div>
<p>Like before, this call will block until Scanner has finished processing all the jobs. You should see a progress bar while Scanner is executing the computation graph as before. Once the jobs are done, <code class="code docutils literal notranslate"><span class="pre">run</span></code> returns the newly computed tables, here shown as <code class="code docutils literal notranslate"><span class="pre">output_tables</span></code>.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Alex Poms, Will Crichton.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>